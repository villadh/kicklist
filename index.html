<!DOCTYPE html>
<!--
Copyright (c) 2016 Twitter Inc.
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0
Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->
<html>
<head>
  <meta charset=utf-8 />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- jQuery -->
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.css">
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.js"></script>
	<title>Kick17 Marathon Checklist</title>

  <!-- Material Design Theming -->
	<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.orange-indigo.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<script type="text/javascript" defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>
	<!-- 
	<link rel="stylesheet" href="main.css">
	-->
  <!-- Firebase -->
<script type="text/javascript" src="https://www.gstatic.com/firebasejs/3.3.0/firebase.js"></script>
<script type="text/javascript">
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyCkC6Wclc26m2OJtD3QfkRNuQ5TQ0QRgUk",
    authDomain: "kick17-checklist.firebaseapp.com",
    databaseURL: "https://kick17-checklist.firebaseio.com",
    storageBucket: "",
  };
  firebase.initializeApp(config);
   // Get a reference to the database service
  var database = firebase.database();
</script>
<script type="text/javascript">
	// queue variables
	var fbQueue = []
		, NOP = 0
		, ADD = 1
		, DEL = 2
		;
	// user variables
	var uid
	, returningVisitor = false
	;
	// database variables
	var setRef = firebase.database().ref('/Sets').orderByKey()
	, cardRef = firebase.database().ref('cards').orderByChild('Set')
	, userRef
	;
	// card variables
	var sets
	, uCards
	, cardTotal = 0
	;
    /**
     * Function called when clicking the Login/Logout button.
     */
    // [START buttoncallback]
    function toggleSignIn() {
      if (!firebase.auth().currentUser) {
        // [START createprovider]
        var provider = new firebase.auth.TwitterAuthProvider();
        // [END createprovider]
        // [START signin]
        firebase.auth().signInWithRedirect(provider);
        // [END signin]
      } else {
        // [START signout]
        firebase.auth().signOut();
        // clear data if user has signed out
        $('#e-mail').empty();
		$('#kick-fan-name').empty();
		$('#mainboard-checklist').empty();
		$("social-photo").src = "";
		$('#display-name').empty();
        // [END signout]
      }
      // [START_EXCLUDE]
      document.getElementById('social-sign-in').disabled = true;
      // [END_EXCLUDE]
    }
    // [END buttoncallback]
    /**
     * initApp handles setting up UI event listeners and registering Firebase auth listeners:
     *  - firebase.auth().onAuthStateChanged: This listener is called when the user is signed in or
     *    out, and that is where we update the UI.
     *  - firebase.auth().getRedirectResult(): This promise completes when the user gets back from
     *    the auth redirect flow. It is where you can get the OAuth token and secret from the IDP.
     */

    function initApp() {
      // Listening for auth state changes.
      // [START authstatelistener]
      firebase.auth().onAuthStateChanged(function(user) {
        if (user) {
    		// User is signed in.
   			//$( ":mobile-pagecontainer" ).pagecontainer("change", "#welcome");

			document.getElementById('sign-in-banner').textContent = 'Welcome to Kicklist';
			document.getElementById('sign-in-hint').textContent = 'Track your marathon sets with this checklist.';

        	var displayName = user.displayName;
        	var email = user.email;
        	var emailVerified = user.emailVerified;
        	var photoURL = user.photoURL;
        	var isAnonymous = user.isAnonymous;
			var providerData = user.providerData;
			uid = user.uid;
			var kickfanname = null
	  			, wImg = document.getElementById("social-photo")
			  	;

			// populate account profile page
			if(displayName){
				$('#display-name').html(displayName);
			}
			if(photoURL ){
				wImg.src = photoURL;
				wImg.style.padding = "1em";
			}
			if(email){
				$('#e-mail').text(email);
			} else{
				$('#e-mail').text('Not provided');
			}

			// listen for page transistions
			$( ":mobile-pagecontainer" ).on( "pagecontainerchange", function( event, ui ) {
				$("#list-button").addClass("ui-btn-active");
			});
			$( ":mobile-pagecontainer" ).on( "pagecontainerbeforechange", function( event, ui ) {
				console.log("pagecontainerbeforechange handler: Navigating to " + ui.toPage);
				// populate account profile page
				if(ui.toPage.toString().endsWith("#profile")){
					console.log("pagecontainerbeforechange handler: updating profile page " + kickfanname);
					if(email)
						$('#e-mail').text(email);
					if(kickfanname)
						$('#kick-fan-name').text(kickfanname);
				}	// end of profile page if
			} );
			// listen for updates to profile
			$("#e-mail-update").on("click",bUpdateEmailHandleClick);
			$("#kick-fan-name-update").on("click",bUpdateKickFanNameHandleClick);
// TODO: save changes
// TODO: save preferences
		  } else {
          // User is signed out.
          // [START_EXCLUDE]
		  document.getElementById('sign-in-banner').textContent = 'Sign In to Get Started';
		  document.getElementById('sign-in-hint').textContent = 'Sign in with your existing Social Media account below.';

          // navigate to sign in page
          $( ":mobile-pagecontainer" ).pagecontainer("change", "#sign-in");
// TODO : clear checklist area
          // [END_EXCLUDE]
        }
        // [START_EXCLUDE]
        document.getElementById('social-sign-in').disabled = false;
        // [END_EXCLUDE]
      });
      // [END authstatelistener]
      document.getElementById('social-sign-in').addEventListener('click', toggleSignIn, false);
    }

	function renderChecklist(){
		$.mobile.loading( "show",
			{
				text : "loading card checklist",
				textVisible : true
			}
		);
		console.log("renderChecklist: requesting set data");
		setRef.once('value')	// promise returning query
			.then( function(setSnapshot){
				console.log("renderChecklist: found: " + setSnapshot.numChildren() + " records at ref " + setRef);
				// render set data
				renderSets(setSnapshot,'#mainboard-checklist');			
				// request card data
				return cardRef.once('value');	// promise returning query
			}	// end of setRef query fulfillment handler
			)
				.then(function(cardSnapshot){
					console.log("renderChecklist: found: " + cardSnapshot.numChildren() + " records at ref " + cardRef);
					// render card data
					renderCards(cardSnapshot);
					return firebase.auth().getRedirectResult(); // promise returning method of Firebase Auth service interface
				}	// end of cardRef query fulfillment handler
				)
					.then(function(result){
						// set user identity
						if(result.user)
							uid = result.user.uid;
						userRef = firebase.database().ref('users/' + uid);
						// request user data
						return userRef.once('value') 	// promise returning query
					}	// end of getRedirectResult fulfillment handler
					)
						.then(function(userSnapshot){
							// determine if user is a returning visitor or new
							returningVisitor = userSnapshot.exists();
							var nextPage = "#";
							if(returningVisitor){
								console.log("renderChecklist: Welcome back!");
								kickfanname = userSnapshot.child('kick/fanname').val();
								if(kickfanname){
									console.log("onAuthStateChanged: Found custom profile");
									$('#kick-fan-name').text(kickfanname);
								} else {
									$('#kick-fan-name').text('Not provided');
								}
								// render user card ownsership 
								renderOwnership(userSnapshot.child('cards'));
								// TODO: filter by user preferences
								// navigate to main page, render jQuery widgets
								nextPage = "#list";
							} else {	// show all marathon cards in database
								console.log("renderChecklist: Hello new visitor!");
//TODO: new visitor sequence
								// navigate to profile page
								nextPage = "#profile";
							}	// end of returningVisitor if
			 //listen for action button clicks
			$('#sign-out-button').click(toggleSignIn);
			$('#save-button').click(bSubmitHandleClick);
			$('#clear-button').click(bClearAllHandleClick);
							// navigate to next page
							$( ":mobile-pagecontainer" ).pagecontainer("change", nextPage);
							// listen for checkbox clicks
							$("input").click(cbHandleClick);
						}// end of userRef query fulfillment handler
						).catch(function(err){
							$.mobile.loading( "hide");
							if(!(uid)){
								console.log("renderChecklist: Too early, retry when someone is signed in");
							}else if(err.message === "user is not defined"){
								console.log("renderChecklist: No user object, sign in error?");
							}else if(err.message === "Cannot read property 'provider' of undefined"){
								console.log("renderChecklist: No redirect results.");
							} else if(err.code === 'auth/account-exists-with-different-credential') {
						          alert('You have already signed up with a different auth provider for that email.');
						          // If you are using multiple auth providers on your app you should handle linking
						          // the user's accounts here.
					        } else {
					          console.error(err);
					        }
						}	// end of rejection handler
			);	// end of async promise chain
	}	// end of function renderChecklist

	function renderSets(fbdbSnapshot, pageID){
		console.log("renderSets: list marathon sets");
// TODO: filter on user preferences
//		setRef.once('value').then(function(setSnapshot){
			var compID = []
			;
			fbdbSnapshot.forEach(function(setChildSnapshot){
				// create elements
				var liSec = document.createElement('li')
					, aSecLi = document.createElement('a')
					, tabSec = document.createElement('div')
					, compTag = setChildSnapshot.child('Tags/0').val()
					, setTag = setChildSnapshot.child('Tags/1').val()
					, ulCompID = compTag + "-menu"
					, ulID = "#" + ulCompID
					, twID = "#"+ compTag
					, fsCards = document.createElement('fieldset')
					, hCards =  document.createElement('legend')
					;

				// identify set tab
				$(tabSec).attr('id', setChildSnapshot.key);
				$(tabSec).attr('class', compTag);
				// set up fieldset for cards
				$(tabSec).addClass('ui-field-contain');
				$(fsCards).attr('data-role','controlgroup');
				//$(fsCards).attr('id', fsID);
				fsCards.id = setChildSnapshot.key + "-fs";
				$(hCards).text(setChildSnapshot.val().Name);
				$(fsCards).append(hCards);
				$(tabSec).append(fsCards);

				// list item is set menu selection
				aSecLi.text = setTag;
				aSecLi.href="#" + setChildSnapshot.key;
				aSecLi.title = setChildSnapshot.key;
				$(liSec).append(aSecLi);
				// check if it is part of a new competition
				if(compID.indexOf(compTag) < 0 ){
					compID.push(compTag);
					var twComp = document.createElement('div')
						, nbComp = document.createElement('div')
						, ulComp = document.createElement('ul')
						;
					$(twComp).attr('id',compTag);
					$(twComp).attr('data-role','tabs');
					$(ulComp).attr('id',ulCompID);
					$(nbComp).attr('data-role','navbar');
					$(nbComp).append(ulComp);
					$(twComp).append(nbComp);
					$(pageID).append(twComp);
					// listen for secondary navbar clicks
					$(twComp).on("click",nbSetHandleClick);
				}
				// add new elements
				$(ulID).append(liSec);
				$(twID).append(tabSec);
			});	// end of forEach
			// add to top level
			var  nbTop = document.createElement('div')
				, ulTop = document.createElement('ul')
				;
			$(nbTop).attr('data-role','navbar');
			for(var i=0; i < compID.length; i++){
				var liTop = document.createElement('li')
					, aLiTop = document.createElement('a')
				aLiTop.id = compID[i] + "-anchor";
				aLiTop.href = "#" + compID[i];
				aLiTop.text = compID[i];
				$(liTop).append(aLiTop);
				$(ulTop).append(liTop);
			}
			$(nbTop).append(ulTop);			
			$('#mainboard-checklist').attr('data-role','tabs');
			$('#mainboard-checklist').prepend(nbTop);
//		});	// end of once value query
		return fbdbSnapshot.numChildren();
	}	// end of function renderSets

	function renderCards(cardsetSnapshot){
		console.log('renderCards: displaying checklist');
		uCards = cardsetSnapshot;
		uCards.forEach(function(cardChildSnapshot){
			var checkArea = document.createElement('input')
				, cardArea = document.createElement('label')
				, cardsetArea = document.getElementById(cardChildSnapshot.val().Set + "-fs")
				;

			checkArea.type = "checkbox";
			checkArea.id = cardChildSnapshot.key;
			checkArea.name = cardChildSnapshot.key;
			//checkArea.setAttribute("class", "custom");
			cardArea.setAttribute('for', cardChildSnapshot.key);
			cardArea.textContent+= cardChildSnapshot.val().Player;
			// check for card variant parallel
			if(cardChildSnapshot.child('Variant').exists())
				cardArea.textContent+= " " + cardChildSnapshot.val().Variant;
			// set input tag value 
			checkArea.value = cardChildSnapshot.child('status').val()
			// update DOM
			$(cardsetArea).append(checkArea);
			$(cardsetArea).append(cardArea);
			//.trigger( "create" );
		});	// end of cards snapshot foreach loop
		return cardsetSnapshot.numChildren()
	}	// end of function renderCards

	function renderOwnership(fbdbSnapshot){
		// check for ownership
		var ownedCards = 0;
		fbdbSnapshot.forEach(function(childSnapshot){
			if(childSnapshot.child('status').val() === 'GOT'){
				document.getElementById(childSnapshot.key).checked = true;
				ownedCards++;
			}	
		});	// end of foreach
		console.log("renderOwnership: " + uid + " owns " + ownedCards + " marathon cards");
		$( ":mobile-pagecontainer" ).pagecontainer("change", "#list");
		$.mobile.loading( "hide");		
		return ownedCards;
	}	// end of function renderOwnership

	function setCardStatus(cardNo, action){
		$("#save-button").removeClass("ui-btn-active");
		var cardRef = firebase.database().ref('users/' + uid +'/cards/' + cardNo)
			, cardData = {}
			;
		
		if(action === ADD){
			console.log("setCardStatus: setting card number " + cardNo + " ownserhip in database");
			cardData = {status: "GOT"};
			cardRef.update(cardData);
		} else if(action === DEL){
			console.log("setCardStatus: removing card number " + cardNo + " ownserhip in database");
			cardData = {status:  "NEED"};
			cardRef.update(cardData);
		} else {
			console.log("setCardStatus: adding card number " + cardNo + " to database for visitor " + uid);
			var cardStatus = {
				Player: uCards.child(cardNo).val().Player,
				Set: uCards.child(cardNo).val().Set,
				status: "NEED"
			};
			if(uCards.child(cardNo).child('Variant').exists())
				cardStatus["Variant"] = uCards.child(cardNo).val().Variant;

			cardData[cardNo] = cardStatus;
			userRef.child('cards/' + cardNo).set(cardData[cardNo]);
		}
	}	// end of function setCardStatus

	function bulkBlockUpdate(fbdbRef, childList){
		var cardData = {}
			;
		while(childList.length){
			var cardIndex = childList.pop()
			, cbState = document.getElementById(cardIndex).checked
			, cardStatus = document.getElementById(cardIndex).value
			;
			
			console.log("blockBulkUpdate: card number " + cardIndex  + " is " + cbState + " and has value of " + cardStatus);
			// status logic
			if(cbState){
				console.log("blockBulkUpdate: sending ADD action for card number " + cardIndex  + " with value " + cbState);
				cardData[cardIndex] = {status : 'GOT'};
			} else {
				console.log("blockBulkUpdate: sending DEL action for card number " + cardIndex  + " with value " + cbState);
				cardData[cardIndex] = {status : 'NEED'};
			}	// end of if
		}	// end of childList while
		// update database
		fbdbRef.update(cardData);
	}	// end of bulkBlockUpdate function

	// DOM event handlers
	function signoutHandleClick(signoutEvent){
		toggleSignIn();
	}	// end of signoutHandleClick function

	function bUpdateKickFanNameHandleClick(updateKickFanNameEvent){
		var tKickFanName = document.getElementsByName(updateKickFanNameEvent.currentTarget.name)[0]
		, tUpdate = tKickFanName.value
		, fbdbRef = firebase.database().ref('users/' + uid +'/kick')
		;
		// clear text field
		$(tKickFanName).val("");
		// update database
		fbdbRef.update({fanname: tUpdate })
			.then(
				function() {
					$( ":mobile-pagecontainer" ).pagecontainer("change", "#fbdb-success", {transition : "pop"});
					kickfanname = tUpdate ;
				}
				, function(err){
					console.error("bUpdateKickFanNameHandleClick: " + err.message);
				}
			);	// end of database refrence update promise
	}	// end of bUpdateKickFanNameHandleClickfunction

	function bUpdateEmailHandleClick(updateEmailEvent){
		var tEmail = document.getElementsByName(updateEmailEvent.currentTarget.name)[0]
		, tUpdate = tEmail.value;
		// clear text field
		$(tEmail).val("");
		// send update request to auth service
		firebase.auth().currentUser.updateEmail(tUpdate)
			.then(
				function() {
					$( ":mobile-pagecontainer" ).pagecontainer("change", "#fbdb-success", {transition : "pop"});
					email = tUpdate ;
				})
			.catch(function(error){
// TODO : handle error.code === "auth/requires-recent-login"
					if(error.code === "auth/invalid-email"){
						alert("Could not update your email to " + tUpdate + " " + error.message );
					}else{				
						console.error(error);
						throw error;
					}
				}
			);	// end of updateEmail promise
	}	// end of bUpdateEmailHandleClick function

	function bSubmitHandleClick(submitEvent){
		console.log("bSubmitHandleClick: submitting changes to database");
		bulkBlockUpdate(userRef, fbQueue);
	}	// end of bSubmitHandleClick

	function bClearAllHandleClick(bClearAllEvent){
		console.log("bClearAllHandleClick: backing out all changes");
		while(fbQueue.length){
			// var cardToClear = document.getElementById(fbQueue.pop());
			var cardToClearId = "#" + fbQueue.pop();
			console.log("bClearAllHandleClick: re-setting card no " + $(cardToClearId).attr('id'));
			// clear all checkboxes in queue
			$(cardToClearId).attr('checked', false);
			// add back cards owned
			if($(cardToClearId).attr('value') === 'GOT')
				$(cardToClearId).attr('checked', true);
			$(cardToClearId).checkboxradio("refresh");
		}	// end of queue length while
	}	// end of bClearAllHandleClick function

	function nbHandleClick(nbEvent){
		// TODO add event handling 
	}	// end of nbHandleClick function

	function nbCompHandleClick(nbCompEvent){
		console.log("nbCompHandleClick: ");
	}	// end of nbCompHandleClick funciton 

	function nbSetHandleClick(nbSetEvent){
		// set active status of top tier navbar when second tier navbar is clicked
		console.log("handleSetNavBarClick: Clicked on tab for set: " + nbSetEvent.currentTarget.id);
		var compTabId = "#" + nbSetEvent.currentTarget.id + "-anchor";
		$(compTabId).addClass("ui-btn-active");
	}	// end of nbSetHandleClick function

	function cbHandleClick(cbEvent){
		var cardNo = cbEvent.currentTarget.name
			, cbState = cbEvent.currentTarget.checked
			, cardStatus = cbEvent.currentTarget.value 
			, cardQueued = fbQueue.indexOf(cardNo);
			;

		if(cardQueued < 0){
			// add card to queue
			console.log("cbHandleClick: adding " + cardNo + " to queue ");
			fbQueue.push(cardNo);
		}
		else{
			// TODO: remove card from fbQueue
			console.log("cbHandleClick: removing " + cardNo + " from queue");
			fbQueue.splice(cardQueued, 1);
		}	// end cardQuese if
	}	// end of cbHandleClick function

$( document ).on( "mobileinit", function() {
//  $.mobile.loader.prototype.options.theme = "a";
//  $.mobile.loader.prototype.options.html = "";
});
	$( document ).on('ready', function(event){// Listening for page init to complete
		initApp();
		renderChecklist();
	}
	);
  </script>
</head>
<body>
<!-- Start of first page: #sign-in -->
<div data-role="page" id="sign-in">
  <!-- Header section containing title -->
	<div data-role="header" data-position="fixed">
		<h1>Kicklist</h1>
	</div><!-- /header -->
	<div data-role="content" class="ui-content">
		<!-- -->
		<div class="mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-cell--12-col-desktop">
	        <div class="mdl-card__title mdl-color--light-blue-600 mdl-color-text--white">
	          <h2 id="sign-in-banner" class="mdl-card__title-text"></h2>
	        </div>
	        <div class="mdl-card__supporting-text mdl-color-text--grey-600" id="action-button-area">
				<p id="sign-in-hint"></p>
				<!-- Button that handles twitter sign-in/sign-out -->
				<button disabled class="mdl-button mdl-js-button mdl-button--raised" id="social-sign-in">Sign in with Twitter</button>
			</div>
		</div>
	</div><!-- /main -->
	<div id="footer" data-role="footer" data-position="fixed" >
	</div><!-- /footer -->
</div><!-- /page one -->

<div data-role="page" id="welcome">

	<div data-role="header" data-position="fixed">
		<h1>Kicklist</h1>
	</div><!-- /header -->

	<div role="main" class="ui-content">
		<p>Welcome <span id="welcome-sign"></span></p>
		
	</div><!-- /content -->

	<div data-role="footer">
	</div><!-- /footer -->
</div><!-- /page -->

<!-- Start of second page: #list -->
<div data-role="page" id="list">
	<div data-role="header" data-position="fixed">
		<h1>Kicklist</h1>
	</div><!-- /header -->
	<div data-role="content" class="ui-content">
		<div id="mainboard-checklist"></div> <!-- end of Mainboard Tabs Area -->
	</div><!-- /main -->
	<div data-role="footer" data-position="fixed" >
    	<div data-role="navbar">
			<ul>
				<li><a id="save-button" href="#" class="ui-btn" data-icon="check">Save</a></li>
				<li><a id="clear-button" href="#" class="ui-btn" data-icon="delete">Clear</a></li>
				<li><a id="list-button" href="#list" class="ui-btn" data-icon="grid">List</a></li>
				<li><a id="profile-button" href="#profile" class="ui-btn" data-icon="user">Profile</a></li>
				<li><a id="sign-out-button" href="#" class="ui-btn" data-icon="arrow-r">Sign Out</a></li>
		    </ul>
		</div><!-- /navbar -->
	</div><!-- /footer -->
</div><!-- /page two -->

<!-- Start of third page: #profile -->
<div data-role="page" id="profile">
	<div data-role="header" data-add-back-btn="true">
		<h1>Kicklist Profile</h1>
	</div><!-- /header -->
	<div data-role="content" class="user-details-container">
		<!-- Listwview widget displaying user details -->
		<ul data-role="listview">
			<li>
				<img alt="" id="social-photo" >
				<h3 id="display-name" ></h3>
			</li>
			<li data-role="list-divider">Contact Information</li>
			<li><a data-rel="dialog" data-transition="pop" href="#update-e-mail" class="ui-btn ui-icon-edit ui-btn-inline ui-btn-icon-right">Email: <span id="e-mail"></span></a></li>
			<li><a data-rel="dialog" data-transition="pop" href="#update-kick-fan-name" class="ui-btn ui-icon-edit ui-btn-inline ui-btn-icon-right">Kick Fan Name: <span id="kick-fan-name"></span></a></li>
			<!-- <li data-role="list-divider">Credentials</li>
			Email password authentication not supported yet <li><a data-rel="dialog" data-transition="pop" href="#update-password" class="ui-btn">Update Password</a></li> -->
		</ul>
	</div><!-- /content -->
	<div data-role="footer" data-position="fixed">
	</div><!-- /footer -->
</div><!-- /page profile -->

<!-- Start of fourth page: #update-e-mail -->
<div data-role="page" id="update-e-mail">
	<div data-role="header">
		<h1>Update Profile</h1>
	</div><!-- /header -->
	<div data-role="content">	
		<h2>Set E-mail</h2>
		<div class="ui-field-contain">
			<label for="e-mail-tf">Enter new E-mail:</label>
        	<input type="e-mail" name="e-mail-tf" id="e-mail-tf" value="">
			<input type="button" name="e-mail-tf" id="e-mail-update" value="Update">
		</div>
	</div><!-- /content -->
	<div data-role="footer">
		<a href="#profile" data-rel="back" class="ui-btn" data-inline="true" data-icon="back">Back to Profile page</a>
	</div><!-- /footer -->
</div><!-- /page popup -->
<!-- Start of fifth page: #update-kick-fan-name -->
<div data-role="page" id="update-kick-fan-name">
	<div data-role="header" data-theme="e">
		<h1>Update Profile</h1>
	</div><!-- /header -->
	<div data-role="content" >
		<h2>Set Kick Name</h2>
		<div class="ui-field-contain">
			<label for="kick-fan-name-tf">Enter your Kick fan name:</label>
   			<input type="text" name="kick-fan-name-tf" id="kick-fan-name-tf" value="">
   			<input type="button" name="kick-fan-name-tf" id="kick-fan-name-update" value="Update">
		</div>
	</div><!-- /content -->
	<div data-role="footer">
		<a href="#profile" data-rel="back" class="ui-btn" data-inline="true" data-icon="back">Back to Profile page</a>
	</div><!-- /footer -->
</div><!-- /page popup -->
<!-- Start of sixth page: #update-password -->
<div data-role="page" id="update-password">
	<div data-role="header" data-theme="e">
		<h1>Update Profile</h1>
	</div><!-- /header -->
	<div data-role="content" data-theme="d">	
		<h2>Set Password</h2>
		<div class="ui-field-contain">
       		<label for="password">Enter a new Password:</label>
	    	<input type="password" name="password" id="password" value="" />
		</div>
	</div><!-- /content -->
	<div data-role="footer">
		<a href="#profile" data-rel="back" class="ui-btn" data-inline="true" data-icon="back">Back to Profile page</a>
	</div><!-- /footer -->
</div><!-- /page popup -->
<!-- Start of database write success page: #fbdb-success -->
<div data-role="page" id="fbdb-success">
	<div data-role="header" data-add-back-btn="true">
		<h1>Update Successful</h1>
	</div><!-- /header -->
	<div data-role="content">	
		<p>Your information has been updated</p>
	</div><!-- /content -->
	<div data-role="footer">
	</div><!-- /footer -->
</div><!-- /page popup -->
</body>
</html>
